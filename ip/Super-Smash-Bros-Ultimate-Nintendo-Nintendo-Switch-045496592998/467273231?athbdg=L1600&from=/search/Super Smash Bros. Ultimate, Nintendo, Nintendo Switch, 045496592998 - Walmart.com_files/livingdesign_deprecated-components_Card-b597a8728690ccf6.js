(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[10629],{617453:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(390239),l=(t(156055),t(489621)),a=t.n(l),o=t(745756),i=t.n(o);const s=e=>{const{children:n,className:t,size:l="medium",...o}=e;return(0,r.jsx)("div",{className:a()(i().card,"medium"===l&&i().medium,"large"===l&&i().large,"small"===l&&i().small,t),...o,children:n})}},119392:function(e,n,t){"use strict";t.d(n,{Df:function(){return g},ny:function(){return v},fx:function(){return S}});var r=t(158529),l=t(961866),a=t(107401),o=t(964226),i=t(978522),s=t(654292),c=t(560241);const d={type:"query",name:"PACPage",query:"query PACPage( $p13n:JSON $pageType:String! $enableUnifiedBadges:Boolean! = false $enableStylistics:Boolean! = false ){contentLayout( channel:\"WWW\" pageType:$pageType tenant:\"WM_GLASS\" version:\"v1\" ){modules(p13n:$p13n tempo:{}){name type version status schedule{start end priority expEnabled}triggers{pageType pageId zone inheritable}publishedDate moduleId module_id matchedTrigger{pageType pageId zone inheritable}configs{__typename...on EnricherModuleConfigsV1{zoneV1}...on TempoWM_GLASSWWWItemCarouselConfigsV1{title subTitle tileOptions{productTitle fulfillmentBadging averageRatings productFlags}spBeaconInfo{adUuid moduleInfo pageViewUUID placement max}type products{...PACProductFragment}minItems manualShelfId _rawConfigs viewAllLink{clickThrough{rawValue tag type value}linkText title}}...on TempoWM_GLASSWWWProductGridConfigsV1{type title displayMode tileOptions{productTitle productPrice fulfillmentBadging averageRatings mediaRatings productFlags productLabels addToCart displayStandardPrice displayWasPrice displayAveragePriceCondition displayPricePerUnit}spBeaconInfo{adUuid moduleInfo pageViewUUID placement max}productGridResponse{products{id sellerId hasSellerBadge canonicalUrl...PACProductFragment}}}...on TempoWM_GLASSWWWAddOnServicesPlaceholderConfigs{products{id usItemId offerId sellerId addOnServices{serviceType serviceTitle serviceSubTitle groups{groupType groupTitle assetUrl shortDescription services{name displayName productId usItemId sellerId offerId currentPrice{price priceString}}}}}}...CompleteTheLookModule...on TempoWM_GLASSWWWStyliticsModulePlaceholderConfigs @include(if:$enableStylistics){_rawConfigs}}}layouts{id layout}pageMetadata{location{pickupStore deliveryStore intent postalCode stateOrProvinceCode city storeId accessType accessPointId spokeNodeId}pageContext}}}fragment PACProductFragment on Product{id usItemId offerId name averageRating numberOfReviews fulfillmentSpeed fulfillmentType availabilityStatus sellerId salesUnit hasSellerBadge showAtc showOptions canonicalUrl imageInfo{thumbnailUrl id name}badges{...BadgesFragment}priceInfo{priceDisplayCodes{finalCostByWeight priceDisplayCondition}shipPrice{priceString}currentPrice{price priceString priceDisplay}wasPrice{priceString}priceRange{priceString}unitPrice{priceString}}promoDiscount{discount discountEligible discountEligibleVariantPresent promotionId promoOffer state}p13nDataV1{labels{PREVIOUSLY_PURCHASED{text}}}sponsoredProduct{spQs clickBeacon}rewards{eligible state minQuantity maxQuantity rewardAmt promotionId selectionToken cbOffer description term expiry rewardMultiplierStr}}fragment BadgesFragment on UnifiedBadge{flags{__typename...on BaseBadge{id text key type query styleId}...on PreviouslyPurchasedBadge{id text key lastBoughtOn numBought criteria{name value}}}labels{__typename...on BaseBadge{id text key}...on PreviouslyPurchasedBadge{id text key lastBoughtOn numBought}}tags{__typename...on BaseBadge{id text key}...on PreviouslyPurchasedBadge{id text key}}groups @include(if:$enableUnifiedBadges){...on UnifiedBadgeGroup{name members{__typename...on BadgeGroupMember{id key text styleId}}}}}fragment CompleteTheLookModule on TempoWM_GLASSWWWItemCompleteTheLookConfigsV1{title subTitle products{...CompleteTheLookProduct}p13nCtlColumn1{...CompleteTheLookColumn}p13nCtlColumn2{...CompleteTheLookColumn}p13nCtlColumn3{...CompleteTheLookColumn}looks{...CompleteTheLookMultipleLooks}}fragment CompleteTheLookProduct on Product{name brand catalogSellerId canonicalUrl availabilityStatus externalInfo{url}id imageInfo{thumbnailUrl id name}priceInfo{currentPrice{...ProductPriceCTLModuleFragment}wasPrice{...ProductPriceCTLModuleFragment}}usItemId}fragment ProductPriceCTLModuleFragment on ProductPrice{price priceString variantPriceString currencyUnit bestValue}fragment CompleteTheLookColumn on TempoWM_GLASSWWWP13nCtlColumn{isAnchor cellSpan index}fragment CompleteTheLookMultipleLooks on TempoWM_GLASSWWWP13nCtlMultipleLooks{p13nCtlColumn1{...CompleteTheLookColumn}p13nCtlColumn2{...CompleteTheLookColumn}p13nCtlColumn3{...CompleteTheLookColumn}}",hash:"0cc275f4c870e05b1d15fd308c675cc5115348f0d5ea43f913d6f26731a0a799"};var u,m,p=t(590723);const y=(0,l.B)(),f=(null===y||void 0===y||null===(u=y.publicRuntimeConfig)||void 0===u||null===(m=u.tempoPageTypes)||void 0===m?void 0:m.postAddtoCartPageType)||"PostAddtoCartPage",g=(e,n)=>({queryKey:["pac",n.itemId],queryFn:()=>e.getGqlFetch()(d,n.p13n)}),v={MARKETPLACE:"FCGroup",FC:"FCGroup",DIGITAL:"FCGroup",STORE:"SCGroup"},w=(e,n,t,r)=>{var l,o,i;const{isMobile:c}=(0,a.vP)(),d=(0,p.Co)(),u=(0,s.ej)("bstc"),m=(0,s.ej)("vtc"),y=(null===d||void 0===d?void 0:d.intent)?null===d||void 0===d?void 0:d.intent:"";var f;return{pageId:e.itemId,offerId:e.offerId,userReqInfo:{preferredStoreId:null===d||void 0===d?void 0:d.storeId,vtc:m,bstc:u,featureAvailable:{hs:t&&(null===(l=e.featureAvailable)||void 0===l?void 0:l.hs),cp:t&&(null===(o=e.featureAvailable)||void 0===o?void 0:o.cp),acc:n&&(null===(i=e.featureAvailable)||void 0===i?void 0:i.acc)},featureSelected:e.featureSelected,cartContext:{items:[{id:e.itemId,price:e.itemPrice,qty:e.quantity,fulfillmentIntent:null===d||void 0===d?void 0:d.intent,fulfillmentGroup:v[null!==(f=e.fulfillmentGroup)&&void 0!==f?f:""]}],...(r&&{cartIntent:y})},refererContext:{source:""}},userClientInfo:{deviceType:c?"mobile":"desktop",callType:"CLIENT"}}},S=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;const t=(0,r.iC)(c.Tg),{enableACCOnPAC:l,enableAddOnServicesPAC:a,enableGroceryPAC:s,enableStylistics:d,enableBenefitSavings:u,enableVetApprovalRequired:m,enablePetRxPrescriptionBadge:p}=t.cart.values,y={p13n:w(n,l,a,s),pageType:f,enableStylistics:d,enableUnifiedBadges:u||m||p},v=g((0,o.Z)(),{p13n:y,itemId:n.itemId});return(0,i.a)({...v,config:{refetchOnWindowFocus:!1,enabled:e}})}},444510:function(e,n,t){"use strict";t.d(n,{p:function(){return s}});var r={};t.r(r),t.d(r,{imageMissingDescription:function(){return i}});var l=t(390239),a=t(575115),o=t(227297);const i=()=>"We're having trouble loading this image",s=()=>(0,l.jsxs)("div",{className:"pa3 flex w-100 h-100 flex-column justify-center items-center bg-nearer-white absolute absolute--fill",children:[(0,l.jsx)(o.J,{name:"Image",size:"large"}),(0,l.jsx)("p",{className:"pt3 ma0 f7 dark-gray",children:(0,a.m)(r,"imageMissingDescription")})]})},936176:function(e,n,t){"use strict";t.d(n,{L:function(){return p}});var r=t(390239),l=t(377922),a=t(916686),o=t(803528),i=t(489621),s=t.n(i),c=t(156055),d=t(444510),u=t(606942),m=t.n(u);const p=e=>{let{title:n,trailingInfo:t,image:i,content:u,switchData:p,bulletPoints:y}=e;const{0:f,1:g}=(0,c.useState)(!0),{0:v,1:w}=(0,c.useState)(!0),S=p&&f?p.secondImage:i;return(0,c.useEffect)(()=>{const e=new Image;e.src=i.src,e.onload=()=>{0===e.height?w(!1):w(!0)},e.onerror=()=>{w(!1)}},[w,i.src]),(0,r.jsxs)("div",{className:"flex-column bg-white",children:[(0,r.jsxs)("div",{className:"flex justify-between mb2 mt2",children:[(0,r.jsx)(a.Heading,{as:"h3",size:"small",weight:700,UNSAFE_className:"f4",UNSAFE_style:{paddingRight:10},children:n}),t&&(0,r.jsx)("span",{className:"flex dark-gray",children:t})]}),(0,r.jsx)("p",{className:"mv0 f6",style:{color:l.LgQ},children:u}),y&&(null===y||void 0===y?void 0:y.length)>0&&(0,r.jsx)("ul",{className:"mt2 pl4",children:y.map(e=>(0,r.jsx)("li",{className:"mb2 f6",style:{color:l.LgQ},children:e.descriptionListItem},e.descriptionListItem))}),(0,r.jsxs)("div",{className:"".concat(!!p&&"ba b--blue"," flex-column mt3 br2 overflow-hidden bg-washed-blue"),children:[(0,r.jsx)("div",{className:"w-100 relative",style:{height:0,paddingBottom:"56.410256%"},children:v?(0,r.jsx)(o.Z,{className:s()(m().image,"absolute absolute--fill"),alt:S.alt,src:S.src,width:"100%",height:"100%",preload:!1}):(0,r.jsx)(d.p,{})}),!!p&&(0,r.jsxs)("div",{className:"flex justify-between pa2 bt b--blue bg-washed-blue",children:[p.switchLabel&&(0,r.jsx)("span",{className:"b f7 blue",style:{marginTop:3,lineHeight:"16px"},children:p.switchLabel}),(0,r.jsx)(a.Switch,{isOn:f,a11yLabelledBy:f?"On":"Off",onClick:()=>g(!f)})]})]})]})}},515868:function(e,n,t){"use strict";t.d(n,{Q:function(){return p}});var r=t(390239),l=t(377922),a=t(235077),o=t(803528),i=t(29695),s=t(489621),c=t.n(s);const d=e=>{const n=e.replace(/-/g," ").split(" ");if(n.length>1){return n.map((e,n)=>0===n?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}return e.toLowerCase()};var u=t(290178),m=t.n(u);const p=e=>{const{analytics:n,header:t,body:s,iconImage:u,isSelected:p,index:y,itemLabel:f,selectHandler:g}=e,v=(0,a.wG)(),w=e=>{("click"===e.type||"keydown"===e.type&&["Enter","Space"].includes(e.code))&&(g(y),v({context:(null===n||void 0===n?void 0:n.context)||"",action:"onClick",name:null===n||void 0===n?void 0:n.name,payload:{pr:{us:null===n||void 0===n?void 0:n.itemID},pg:{nm:null===n||void 0===n?void 0:n.name},li:{nm:d(t)},nm:{nm:d(t)},ta:{pt:null===n||void 0===n?void 0:n.name,ty:null===n||void 0===n?void 0:n.pageType}}}))};return(0,r.jsx)("div",{className:c()("ba br3 flex flex-column",p?"b--blue":m().borderDefault),style:{borderWidth:.5,minHeight:104},children:(0,r.jsx)("div",{className:c()("ba br3 flex-auto",p?"b--blue":"b--transparent"),style:{borderWidth:2.5},children:(0,r.jsxs)(i.ZP,{className:"flex pa3 na1 pointer","aria-label":"".concat(t," ").concat(s," ").concat(f||""),role:"button","aria-pressed":p,tabIndex:0,onClick:w,onKeyDown:w,onLinkName:"selectionItem",onLinkExtras:{li:{nm:t}},children:[(0,r.jsx)("span",{className:c()(m().iconContainer,"mr3 flex-shrink-0 flex br-100"),"data-testid":"hw-selection-item-icon",children:u&&(0,r.jsx)(o.Z,{alt:u.alt,src:u.src,width:"100%",height:"100%",preload:!0,fetchPriority:"high"})}),(0,r.jsxs)("div",{className:"w-100",children:[(0,r.jsxs)("div",{className:"flex justify-between lh-title mb2",children:[(0,r.jsx)("h3",{className:"f4 ma0 mr2 dark-gray",children:t}),(0,r.jsx)("span",{className:"f5 tr dark-gray",children:f})]}),(0,r.jsx)("div",{className:"w-75",children:(0,r.jsx)("span",{className:"f6",style:{color:l.LgQ},children:s})})]})]})})})}},833836:function(e,n,t){"use strict";t.d(n,{Gn:function(){return l},Sm:function(){return i},Xx:function(){return a},ax:function(){return o}});var r=t(250354);const l=()=>(0,r.nG)(e=>e.selectedAddonServices),a=()=>(0,r.nG)(e=>e.setSelectedAddonServices),o=()=>(0,r.nG)(e=>e.addOnServiceRef),i=()=>(0,r.nG)(e=>e.updateAddOnServiceRef)},970780:function(e,n,t){"use strict";t.d(n,{b:function(){return wt}});var r={};t.r(r),t.d(r,{alertMissingOption:function(){return I},continueLabel:function(){return L},currency:function(){return b},errorMessageFeature:function(){return h},gotItLabel:function(){return A},headerAddOns:function(){return C},headerLensColor:function(){return P},headerLensMaterial:function(){return _},headerLensType:function(){return N},headerReview:function(){return T},headerRxType:function(){return R},labelAddOns:function(){return F},labelLensColor:function(){return V},labelLensMaterial:function(){return M},labelLensType:function(){return j},labelReview:function(){return O},labelRxType:function(){return W},reviewPanelTitle:function(){return U},rxAdded:function(){return D},selectionPanelTitle:function(){return k},subtotal:function(){return G}});var l={};t.r(l),t.d(l,{cta:function(){return Gn},editBtn:function(){return Bn},framesLabel:function(){return qn},lensesAddOns:function(){return Zn},lensesColor:function(){return Jn},lensesLabel:function(){return zn},lensesMaterial:function(){return Kn},lensesType:function(){return $n},nudgeLabel:function(){return Qn},nudgeLabelAdded:function(){return Xn},reviewLabel:function(){return Hn},subtotalLabel:function(){return Yn}});var a=t(390239),o=t(482034),i=t(916686),s=t(575115),c=t(235077),d=t(964226),u=t(978522),m=t(683433);const p={type:"query",name:"LensCustomizationProductIdmlQuery",query:"query LensCustomizationProductIdmlQuery( $itemId:String! $associateBundleId:String! ){product(itemId:$itemId associatedBundleId:$associateBundleId){usItemId type offerId groupMetaData{groupType groupSubType groupComponents{usItemId offerId productName productId priceInfo{currentPrice{price priceString currencyUnit}}attributes{name value price}}}bundleCriteria{name displayName options{type bundleComponentIds}}}idml(itemId:$itemId){visionImage{lensType lensColor imageUrl}}contentLayout( channel:\"WWW\" pageType:\"HWVisionResourceItems\" tenant:\"WM_GLASS\" ){modules{name type configs{...on TempoWM_GLASSWWWHWVisionLensBuilderResourceItemsConfigs{sections{sectionIdentifier resourceItems{identifier images{imageKey imageURL{height width alt src}}title description}}}}}}}",hash:"a2f77f3663ff867ab0336428704e78162586700978fb70a29f14824517f37fe2"},y=e=>{const n=((e,n)=>({queryKey:["get-lens-builder",n],queryFn:()=>e.getGqlFetch()(p,n)}))((0,d.Z)(),e),{data:t,error:r,isFetching:l,isLoading:a}=(0,u.a)({...n,config:{refetchOnWindowFocus:!1,staleTime:3e5,cacheTime:6e5}});return{errors:(0,m.k)(null===t||void 0===t?void 0:t.errors,r),isFetching:l,isLoading:a,data:null===t||void 0===t?void 0:t.data}};var f=t(437995),g=t(271492),v=t(623122),w=t.n(v),S=t(156055);const x=w()(async()=>(await t.e(60753).then(t.bind(t,577693))).ErrorPage,{loadableGenerated:{webpack:()=>[577693]}});class E extends S.Component{static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){const{modules:t,scope:r,lineItemId:l,associatedBundleId:a,usItemId:o,offerId:i}=this.props;(0,g.cM)(["error",r,"errorBoundary"],{type:"log",message:e.message,stack:n.componentStack,modules:t,lineItemId:l,associatedBundleId:a,usItemId:o,offerId:i})}render(){const{error:e}=this.state;if(e){const{FallbackComponent:n=x,allowReactContext:t,...r}=this.props;return(0,a.jsx)(n,{...r,errorToLog:e,allowReactContext:t})}return this.props.children}constructor(e){super(e),this.state={}}}const I=()=>"Select an option to continue.",L=()=>"Continue",b=e=>"$"+e.price,h=()=>"You'll be able to use this feature when everything is fixed.",A=()=>"Got it",C=()=>"Is there anything you want to add?",P=()=>"What color lenses would you like?",_=()=>"What lens material works for you?",N=()=>"What type of lenses do you need?",T=()=>"Does everything look right to you?",R=()=>"What's your prescription type?",F=()=>"Add-ons",V=()=>"Lens color",M=()=>"Lens material",j=()=>"Lens type",O=()=>"Review",W=()=>"Prescription type",U=()=>"Review your selections",D=()=>"Prescription added",k=()=>"Select your lenses",G=()=>"Subtotal",B="sunglasses";var q,z;!function(e){e.RX_TYPE="RX_TYPE",e.LENS_TYPE="LENS_TYPE",e.LENS_MATERIAL="LENS_MATERIAL",e.ADD_ONS="ADD_ONS",e.LENS_COLOR="LENS_COLOR",e.REVIEW="REVIEW"}(q||(q={})),function(e){e.FRAMES="Frames",e.LENSES="Lenses"}(z||(z={}));const Q=(e,n,t,r,l)=>{var a;const o=null===e||void 0===e||null===(a=e.sections)||void 0===a?void 0:a.find(e=>e.type===n.currentStep);if(!o)return(0,g.cM)(["error","vision-center","getCurrentResourceItems"],{type:"log",message:"[024] - resourceItemsConfigs (Tempo Data) is missing a section for currentStep: ".concat(n.currentStep),modules:["lens-selection"]}),null;const i=t.reduce((e,a)=>{var i;const s=null===o||void 0===o||null===(i=o.resourceItems)||void 0===i?void 0:i.find(e=>((e,n,t,r)=>{var l,a,o,i;return e.subidentifier?(null===(l=e.identifier)||void 0===l?void 0:l.toLowerCase())===(null===(a=n.type)||void 0===a?void 0:a.toLowerCase())&&(e.subidentifier.toLowerCase()===B&&r||!!t.find(n=>{var t,r;return(null===(t=n.type)||void 0===t?void 0:t.toLowerCase())===(null===(r=e.subidentifier)||void 0===r?void 0:r.toLowerCase())})):(null===(o=e.identifier)||void 0===o?void 0:o.toLowerCase())===(null===(i=n.type)||void 0===i?void 0:i.toLowerCase())})(e,a,r,l));return s?e.push({...s,itemLabel:(null===a||void 0===a?void 0:a.itemLabel)||""}):(0,g.cM)(["error","vision-center","getCurrentResourceItems"],{type:"log",message:"[025] - currentSection resourceItems is missing item for current selectionList: ".concat(t,", currentStep: ").concat(n.currentStep),modules:["lens-selection"]}),e},[]);return{...o,resourceItems:i}},X=e=>"$".concat(e||0),H=(e,n,t)=>{const r=n.filter(e=>{var n;return"no add-ons"!==(null===(n=e.type)||void 0===n?void 0:n.toLowerCase())}).map(e=>({variant:e.header,value:e.price?X(e.price):"Included",type:e.step})),l=t.map(e=>({variant:e.key,value:e.value}));return{totalPrice:X(n.reduce((e,n)=>e+n.price,e)),framesPrice:X(e),lensesPrice:X(n.reduce((e,n)=>e+n.price,0)),framesSelection:l,lensesSelection:[...r]}},Y=e=>e.length,$=e=>{switch(e){case q.RX_TYPE:return(0,s.m)(r,"labelRxType");case q.LENS_TYPE:return(0,s.m)(r,"labelLensType");case q.LENS_MATERIAL:return(0,s.m)(r,"labelLensMaterial");case q.LENS_COLOR:return(0,s.m)(r,"labelLensColor");case q.ADD_ONS:return(0,s.m)(r,"labelAddOns");case q.REVIEW:return(0,s.m)(r,"labelReview");default:return"";}},K=e=>null!=e,J=(e,n,t,r)=>{if(!e.offerId||!e.usItemId)throw new Error("[016] - buildItemBundleComponents: No offerId or usItemId provided by item page. Required for ATC. item: ".concat(JSON.stringify(e)));const l={...e};if(l.offerId=r.offerId,l.usItemId=r.usItemId,1===n.remainingIds.length){var a,o;const t=null===r||void 0===r||null===(a=r.groupMetaData)||void 0===a||null===(o=a.groupComponents)||void 0===o?void 0:o.find(e=>e.productId===n.remainingIds[0]);if(t){const n=[{offerId:e.offerId,quantity:1,product:{name:e.product.name,usItemId:e.usItemId,imageInfo:{thumbnailUrl:null}}},{offerId:t.offerId,quantity:2,product:{name:t.productName,usItemId:t.usItemId,imageInfo:{thumbnailUrl:null}}}];return l.bundleComponents?l.bundleComponents.concat(n):l.bundleComponents=n,l}throw new Error("[017] - groupComponent is not available in SOT data for productId : ".concat(n.remainingIds[0]))}throw new Error("[018] - Progress state remainingIds is not equal to 1 StepsData : ".concat(t.map(e=>"".concat(e.step," : ").concat(e.type))," and remainingId's : ").concat(n.remainingIds))},Z=e=>{switch(e){case q.RX_TYPE:return"prescriptionType";case q.LENS_TYPE:return"lensType";case q.LENS_MATERIAL:return"lensOptions";case q.LENS_COLOR:return"lensColor";case q.ADD_ONS:return"lensAddons";case q.REVIEW:return"reviewLensSelection";default:return e;}},ee=["contentLayout.modules[*].configs.sections[*].resourceItems[*].description","contentLayout.modules[*].configs.sections[*].resourceItems[*].images","contentLayout.modules[*].configs.sections[*].resourceItems[*].images[*].imageKey","contentLayout.modules[*].configs.sections[*].resourceItems[*].images[*].imageURL"];function ne(e,n){for(const l of n){const n=l.split("."),a=e.split(".");if(n.length!==a.length)continue;let o=!0;for(let e=0;e<n.length;e++){var t;const l=null!==(t=n[e])&&void 0!==t?t:"";var r;const i=null!==(r=a[e])&&void 0!==r?r:"";if("*"!==l&&i!==l){if(l.includes("[*]")&&i.includes("[")){const e=l.indexOf("[*]"),n=i.indexOf("[");if(l.substring(0,e)===i.substring(0,n))continue}o=!1;break}}if(o)return!0}return!1}function te(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Array.isArray(e))for(let r=0;r<e.length;r++){const l=n?"".concat(n,"[").concat(r,"]"):"[".concat(r,"]");if(null===e[r]&&!ne(l,t))throw new Error("[019] - LensCustomizationProductIdmlQueryResult data invalid. Null property found at ".concat(l));"object"===typeof e[r]&&te(e[r],l,t)}else for(const r in e){const l=n?"".concat(n,".").concat(r):r;if(null===e[r]&&!ne(l,t))throw new Error("[020] - LensCustomizationProductIdmlQueryResult data invalid. Null property found at ".concat(l));"object"===typeof e[r]&&te(e[r],l,t)}}const re=e=>(te(e,"",ee),e);var le,ae;!function(e){e.ATTEMPT_CONFIRM_SELECTION="ATTEMPT_CONFIRM_SELECTION",e.BACK_PREVIOUS_STEP="BACK_PREVIOUS_STEP",e.BACK_TO_STEP="BACK_TO_STEP",e.GO_TO_REVIEW_STEP="GO_TO_REVIEW_STEP",e.CONFIRM_SELECTION="CONFIRM_SELECTION",e.INITIAL_PROGRESS="INITIAL_PROGRESS",e.SELECT_SELECTION="SELECT_SELECTION",e.SET_SELECTED_ITEMS="SET_SELECTED_ITEMS",e.SET_ITEM="SET_ITEM",e.UPDATE_PROGRESS="UPDATE_PROGRESS",e.TOGGLE_RESOURCE_PANEL="TOGGLE_RESOURCE_PANEL",e.TOGGLE_ADD_PRESCRIPTION_PANEL="TOGGLE_ADD_PRESCRIPTION_PANEL",e.SET_ADD_PRESCRIPTION_PROPS="SET_ADD_PRESCRIPTION_PROPS",e.SET_PROGRESS="SET_PROGRESS"}(le||(le={})),function(e){e.PRESCRIPTION_TYPE="prescription_type",e.LENS_TYPE="lens_type",e.LENS_MATERIAL="lens_material",e.LENS_COLOR="lens_color",e.LENS_ADD_ONS="lens_add_ons"}(ae||(ae={}));const oe=(e,n,t,r)=>{if(r.length<=0)return e;const l=n.bundleCriteria.find(e=>ye[e.name]===t);if(!l)throw new Error("[001] - No bundleCriteria name found for currentStep: ".concat(t));const a=r.find(e=>e.step===ye[l.name]);if(!a)throw new Error("[002] - No currently selectedItem found matching currentStepCriteria: ".concat(ye[null===l||void 0===l?void 0:l.name]," / ").concat(null===l||void 0===l?void 0:l.name));const o=l.options.find(e=>e.type===a.type);if(!o)throw new Error("[003] - No bundleCriteria option found matching selectedItem: ".concat(a.type,", currentStep: ").concat(t));const i=e.filter(e=>o.bundleComponentIds.includes(e));if(i.length<=0)throw new Error("[004] - No remainingIds match bundleComponentIds for option: ".concat(o.type,", currentStep: ").concat(t));return i},ie=e=>{const n=[];for(let r=0;r<e.bundleCriteria.length;r++){const t=e.bundleCriteria[r],l=null===t||void 0===t?void 0:t.options.map(e=>e.bundleComponentIds).flat();n.push(l)}const t=n.flat().filter(e=>"string"===typeof e);return[...new Set(t)]},se=e=>{var n;return parseInt((null===(n=null===e||void 0===e?void 0:e.match(/\d+/))||void 0===n?void 0:n[0])||"0",10)},ce=(e,n,t,r)=>{var l;const a=n.product.bundleCriteria.find(e=>ye[e.name]===t);if(!a)throw new Error("[007] - bundleCriteria name not found in our map. currentStep: ".concat(t));const o=a.options.reduce((n,t)=>(e.find(e=>t.bundleComponentIds.includes(e))&&n.push(t),n),[]);if(0===(null===o||void 0===o?void 0:o.length))return[];let i=me(n.product.groupMetaData.groupComponents,t,e,o);return i=pe(n.contentLayout.modules,i,r,t,(null===(l=n.product.type)||void 0===l?void 0:l.toLowerCase())===B),i=i.sort((e,n)=>e.price+n.price>0?e.price-n.price:se(e.itemLabel)-se(n.itemLabel)),i},de=e=>{switch(e){case q.RX_TYPE:return ae.PRESCRIPTION_TYPE;case q.LENS_TYPE:return ae.LENS_TYPE;case q.LENS_MATERIAL:return ae.LENS_MATERIAL;case q.LENS_COLOR:return ae.LENS_COLOR;case q.ADD_ONS:return ae.LENS_ADD_ONS;default:return null;}},ue=e=>2*e,me=(e,n,t,r)=>{const l=de(n);return r.map(r=>{const a=r.bundleComponentIds.filter(e=>t.includes(e));if(!a||0===a.length)throw new Error("[008] - No bundleComponentIds in current option match current remainingIds. remainingIds ".concat(t,", bundleComponentIds ").concat(null===r||void 0===r?void 0:r.bundleComponentIds,", step: ").concat(l));if(l===ae.PRESCRIPTION_TYPE||l===ae.LENS_TYPE){const t=a.reduce((n,t)=>{const r=e.find(e=>e.productId===t);return 0===n||r&&r.priceInfo.currentPrice.price<n?(null===r||void 0===r?void 0:r.priceInfo.currentPrice.price)||0:n},0);return{type:r.type,step:n,itemLabel:"From +$".concat(ue(t)),price:0,header:"",body:"",iconImage:{height:"",width:"",alt:"",src:""}}}{const t=e.find(e=>a.includes(e.productId));if(!t)throw new Error("[009] - No groupComponent produdctId found in current xIds: ".concat(a,", step: ").concat(l));const o=t.attributes.find(e=>e.name===l);if("undefined"===typeof o)throw new Error("[010] - No attribute name in groupItem matches current step. groupItem: ".concat(null===t||void 0===t?void 0:t.productId,", step: ").concat(l));const i=ue(o.price||0);return{type:r.type,step:n,itemLabel:i?"+$".concat(i):"",price:i,header:"",body:"",iconImage:{height:"",width:"",alt:"",src:""}}}})},pe=(e,n,t,r,l)=>{var a;const o=null===(a=e.find(e=>"HWVisionLensBuilderResourceItems"===e.type))||void 0===a?void 0:a.configs.sections;if(!o)throw new Error("[011] - No module type found in tempoData for HWVisionLensBuilderResourceItems");const i=de(r);return n.map(e=>{var a;const s=((null===(a=o.find(e=>{var n;return(null===(n=e.sectionIdentifier)||void 0===n?void 0:n.toLowerCase())===i}))||void 0===a?void 0:a.resourceItems)||[]).find(n=>n.identifier.toLowerCase()===e.type.toLowerCase());if(!s)throw new Error("[012] - No tempoData item found in current options/selectedItems. ".concat(JSON.stringify(n)));if(!s.title)throw new Error("[013] - tempoData item missing title field from response. ".concat(JSON.stringify(n),"."));const c=((e,n,t)=>{let r;if(t){var l,a;r=(null===(l=e.images)||void 0===l?void 0:l.find(e=>{var n;return(null===(n=e.imageKey)||void 0===n?void 0:n.toLowerCase())===B}))||(null===(a=e.images)||void 0===a?void 0:a.find(e=>{var n;return"all"===(null===(n=e.imageKey)||void 0===n?void 0:n.toLowerCase())}))}else{var o,i;const t=n.map(e=>{var n;return null===(n=e.type)||void 0===n?void 0:n.toLowerCase()});r=(null===(o=e.images)||void 0===o?void 0:o.find(e=>!!e.imageKey&&t.includes(e.imageKey.toLowerCase())))||(null===(i=e.images)||void 0===i?void 0:i.find(e=>{var n;return"all"===(null===(n=e.imageKey)||void 0===n?void 0:n.toLowerCase())}))}return(null===r||void 0===r?void 0:r.imageURL)?r.imageURL:((0,g.cM)(["error","vision-center","getImageData"],{type:"log",message:"[022] - No tempoData imageKey matches current selected Items.",modules:["lens-selection"],selectedItems:n,tempoDataItemId:null===e||void 0===e?void 0:e.identifier}),null)})(s,t,l);return s.description&&c||(0,g.cM)(["error","vision-center","mapTempoData"],{type:"log",message:"[023] - tempoData missing description or imageData for icon",modules:["lens-selection"],selectedItems:t,tempoDataItem:JSON.stringify(s),imageUrlData:JSON.stringify(c)}),{...e,step:r,type:e.type,header:s.title,body:s.description||"",iconImage:c||{src:"https://i5.walmartimages.com/dfw/63fd9f59-c9cb/d9a512b8-9286-4ee3-8ae6-5c2869b5676c/v1/vision-center-default-selection-item-icon.png",alt:""}}})},ye={prescription_type:q.RX_TYPE,lens_type:q.LENS_TYPE,lens_material:q.LENS_MATERIAL,lens_color:q.LENS_COLOR,lens_add_ons:q.ADD_ONS},fe=e=>{var n;return null===e||void 0===e||null===(n=e.bundleCriteria)||void 0===n?void 0:n.reduce((e,n,t,r)=>{var l;const a=ye[null===n||void 0===n?void 0:n.name];if(!a)throw new Error("[014] - bundleCriteria name is invalid. criteria.name: ".concat(null===n||void 0===n?void 0:n.name));const o=(null===(l=r[t+1])||void 0===l?void 0:l.name)||"";return e[a]=ye[o]||q.REVIEW,e},{})},ge=(e,n,t,r)=>{const l=de(n),a=e.bundleCriteria.findIndex(e=>e.name===l);let o=r;if(n===q.REVIEW)return r+1;for(let i=a;i<e.bundleCriteria.length;i++){const r=e.bundleCriteria[i];if(!r)throw new Error("[015] - bundleCriteria index out of bounds, Step index: ".concat(a,", corrupted. Current step: ").concat(n));const l=r.options.map(e=>e.bundleComponentIds).flat();t.find(e=>l.indexOf(e)>-1)&&o++}return o+1},ve=(e,n,t,r)=>{var l,a;if("none"===t)return e.find(e=>{var n;return"none"===(null===(n=e.lensColor)||void 0===n?void 0:n.toLowerCase())});let o=null===(l=n.find(e=>e.step===q.LENS_TYPE))||void 0===l||null===(a=l.type)||void 0===a?void 0:a.toLowerCase();return r&&(o=B),o?e.find(e=>{var n,r;return(null===(n=e.lensType)||void 0===n?void 0:n.toLowerCase())===o&&(null===(r=e.lensColor)||void 0===r?void 0:r.toLowerCase())===t.toLowerCase()}):e.find(e=>{var n;return"none"===(null===(n=e.lensColor)||void 0===n?void 0:n.toLowerCase())})},we=(e,n)=>{switch(n.type){case le.ATTEMPT_CONFIRM_SELECTION:return Se(e);case le.BACK_PREVIOUS_STEP:return Ie(e);case le.BACK_TO_STEP:return Ee(e,n.payload);case le.GO_TO_REVIEW_STEP:return xe(e);case le.CONFIRM_SELECTION:return be(e);case le.INITIAL_PROGRESS:return he(e,n.payload);case le.SELECT_SELECTION:return Ae(e,n.payload);case le.SET_SELECTED_ITEMS:return Ce(e,n.payload);case le.SET_ITEM:return Pe(e,n.payload);case le.UPDATE_PROGRESS:return Ne(e);case le.TOGGLE_RESOURCE_PANEL:return Te(e,n.payload);case le.TOGGLE_ADD_PRESCRIPTION_PANEL:return Re(e,n.payload);case le.SET_ADD_PRESCRIPTION_PROPS:return Fe(e,n.payload);case le.SET_PROGRESS:return _e(e,n.payload);default:return e;}},Se=e=>({...e,selections:{...e.selections,confirmAttempted:!0}}),xe=e=>{const n=e.progress.savedProgress?{...e.progress.savedProgress}:{...e.progress};return{...e,progress:{...n,savedProgress:void 0},selections:{...e.selections,isEditModeNoChanges:!1}}},Ee=(e,n)=>{const t={...e,selections:{...e.selections,isEditModeNoChanges:!0},progress:{...e.progress,savedProgress:{...JSON.parse(JSON.stringify(e.progress))}}},r=t.progress.stepsFlow.indexOf(n),l=t.progress.stepsFlow[r]||q.RX_TYPE;return t.progress.stepsFlow.splice(r),Le(t,l,r)},Ie=e=>{const n=e.progress.stepsFlow.pop()||q.RX_TYPE,t=Y(e.progress.stepsFlow),r=JSON.stringify(e.selections.selectedItems)===JSON.stringify(e.selections.confirmedSelectedItems),l=!!e.progress.savedProgress&&r;let a={...e,selections:{...e.selections,confirmedSelectedItems:e.selections.selectedItems,isEditModeNoChanges:l}};return e.progress.savedProgress&&!r&&(a={...a,progress:{...e.progress,savedProgress:void 0}}),Le(a,n,t)},Le=(e,n,t)=>{const r=e.selections.selectedItems.slice(0,t),l=e.item.basePrice+(r.reduce((e,n)=>e+n.price,0)||0),a=((e,n,t)=>{const r=de(n),l=e.bundleCriteria.findIndex(e=>e.name===r);let a=ie(e);for(let o=0;o<l;o++){const r=e.bundleCriteria[o];if(!r)throw new Error("[005] - bundleCriteria index out of bounds, Step index: ".concat(l,", corrupted. Current step: ").concat(n));const i=ye[r.name];if(t.find(e=>e.step===i)){if(!i)throw new Error("[006] - bundleCriteria step: ".concat(r.name," doesn't exist in our stepMap. Current step: ").concat(n));a=oe(a,e,i,t)}}return a})(e.sotData.product,n,r),o=ce(a,e.sotData,n,r),i=ge(e.sotData.product,n,a,t);return{...e,progress:{...e.progress,currentStep:n,label:$(n),totalSteps:i,value:t*(100/(i-1)),valueLabel:"Step ".concat(t+1," of ").concat(i),remainingIds:a,isUserLoginRedirect:!1},selections:{...e.selections,localSelection:{...e.selections.selectedItems[t]},selectionList:o,displaySubtotal:l,subtotal:l}}},be=e=>{if("undefined"===typeof e.selections.localSelection)return e;const n=e.selections.subtotal+e.selections.localSelection.price;return{...e,selections:{...e.selections,confirmedSelectedItems:e.selections.selectedItems,localSelection:void 0,confirmAttempted:!1,displaySubtotal:n,subtotal:n}}},he=(e,n)=>{const t=ie(e.sotData.product),r=ge(e.sotData.product,n.currentStep,t,0);return{...e,progress:{...e.progress,...n,label:$(n.currentStep),stepsFlow:[],totalSteps:r,value:0,valueLabel:"Step 1 of ".concat(r),remainingIds:t},selections:{...e.selections,selectionList:ce(t,e.sotData,n.currentStep,[])}}},Ae=(e,n)=>{var t;const r=Y(e.progress.stepsFlow),l={...n,step:e.progress.currentStep};let a,o,i=!0,s=e.selections.subtotal+n.price;-1===n.index?(a=e.selections.confirmedSelectedItems.slice(0,r),s=e.item.basePrice+a.reduce((e,n)=>e+n.price,0),i=!1):e.selections.confirmedSelectedItems[r]&&l.type===(null===(t=e.selections.confirmedSelectedItems[r])||void 0===t?void 0:t.type)?(a=[...e.selections.confirmedSelectedItems.slice(0,r),l,...e.selections.confirmedSelectedItems.slice(r+1)],i=!0):(a=[...e.selections.confirmedSelectedItems.slice(0,r),l],i=!1);const c=a.find(e=>e.step===q.LENS_COLOR);o=c?ve(e.sotData.idml.visionImage,a,c.type,e.selections.isSunglasses):ve(e.sotData.idml.visionImage,a,"none");const d=!!e.progress.savedProgress&&i,u=-1===n.index?void 0:l;return(null===o||void 0===o?void 0:o.imageUrl)!==e.item.image.src?{...e,selections:{...e.selections,selectedItems:a,localSelection:u,displaySubtotal:s,confirmAttempted:!1,isEditModeNoChanges:d},item:{...e.item,image:{...e.item.image,src:(null===o||void 0===o?void 0:o.imageUrl)||""}}}:{...e,selections:{...e.selections,selectedItems:a,localSelection:u,displaySubtotal:s,confirmAttempted:!1,isEditModeNoChanges:d}}},Ce=(e,n)=>({...e,selections:{...e.selections,selectedItems:n,confirmedSelectedItems:n}}),Pe=(e,n)=>{var t,r,l,a;if(e.item.atcItem.usItemId===n.atcItem.usItemId)return e;const o=null===(t=e.sotData.idml.visionImage)||void 0===t?void 0:t.find(e=>"none"===e.lensColor.toLowerCase());if(!(null===n||void 0===n||null===(r=n.atcItem)||void 0===r?void 0:r.offerId)||!(null===n||void 0===n||null===(l=n.atcItem)||void 0===l?void 0:l.usItemId))throw new Error("[021] - No offerId or usItemId provided by item page. Required for ATC. payload item: ".concat(JSON.stringify(null===n||void 0===n?void 0:n.atcItem)));return{...e,item:{...e.item,...n,basePrice:null===(a=n.atcItem)||void 0===a?void 0:a.price,heading:n.heading,image:{src:(null===o||void 0===o?void 0:o.imageUrl)||"",alt:n.heading,title:n.heading}},selections:{...e.selections,displaySubtotal:n.basePrice,subtotal:n.basePrice}}},_e=(e,n)=>({...e,progress:{...e.progress,...n}}),Ne=e=>{const n=e.progress.stepsFlow.length+1;let t=e.nextStepMap[e.progress.currentStep]||q.RX_TYPE,r=e.progress.remainingIds,l=e.selections.selectionList;if(r=oe(e.progress.remainingIds,e.sotData.product,e.progress.currentStep,e.selections.selectedItems),t!==q.REVIEW){for(l=ce(r,e.sotData,t,e.selections.selectedItems);l&&l.length<1&&e.nextStepMap[t]!==q.REVIEW;)t=e.nextStepMap[t]||q.RX_TYPE,l=ce(r,e.sotData,t,e.selections.selectedItems);l&&l.length<1&&e.nextStepMap[t]===q.REVIEW&&(t=q.REVIEW)}const a=ge(e.sotData.product,t,r,n);return{...e,progress:{...e.progress,label:$(t),currentStep:t,totalSteps:a,stepsFlow:[...e.progress.stepsFlow,e.progress.currentStep],value:n*(100/(a-1)),valueLabel:"Step ".concat(n+1," of ").concat(a),remainingIds:r,isUserLoginRedirect:!1},selections:{...e.selections,selectionList:l}}},Te=(e,n)=>({...e,resourceItems:{...e.resourceItems,isPanelOpen:n}}),Re=(e,n)=>e.progress.isUserLoginRedirect?{...e,progress:{...e.progress,isUserLoginRedirect:!1},addPrescriptionPanel:{...e.addPrescriptionPanel,isPanelOpen:n}}:{...e,addPrescriptionPanel:{...e.addPrescriptionPanel,isPanelOpen:n}},Fe=(e,n)=>({...e,addPrescriptionPanel:{...e.addPrescriptionPanel,...n}}),Ve={item:{basePrice:0,heading:"",image:{src:"",title:"",alt:""},atcItem:{id:"",offerId:"",usItemId:"",price:0,product:{name:"",imageUrl:""}},associatedBundleId:"",variants:[]},progress:{label:"Step 1",currentStep:q.RX_TYPE,totalSteps:0,stepsFlow:[],value:0,valueLabel:"",remainingIds:[],isUserLoginRedirect:!1,isTriggerUserLogin:!1},selections:{confirmedSelectedItems:[],selectedItems:[],selectionList:[],confirmAttempted:!1,displaySubtotal:0,subtotal:0,isEditModeNoChanges:!1,isSunglasses:!1},sotData:{product:{},idml:{},contentLayout:{}},resourceItems:{isPanelOpen:!1},addPrescriptionPanel:{isPanelOpen:!1,ecomVisionRxId:"",ecomProfileId:"",errors:null},nextStepMap:{}},Me=(0,S.createContext)(null),je=(0,S.createContext)(null),Oe=(0,S.createContext)(null),We=(0,S.createContext)(null),Ue=(0,S.createContext)(null),De=(0,S.createContext)(null),ke=(0,S.createContext)(null),Ge=e=>{let{children:n,data:t}=e;const{0:r,1:l}=(0,S.useReducer)(we,(e=>{var n,t;let r=e;const l=(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.type)||void 0===t?void 0:t.toLowerCase())===B;var a;return l&&(r={...e,product:{...e.product,bundleCriteria:null===(a=e.product.bundleCriteria)||void 0===a?void 0:a.filter(e=>(null===e||void 0===e?void 0:e.name)!==ae.LENS_TYPE)}}),{...Ve,selections:{...Ve.selections,isSunglasses:l},sotData:r,nextStepMap:fe(r.product)}})(re(t))),o=(0,S.useMemo)(()=>({attemptConfirm:()=>{l({type:le.ATTEMPT_CONFIRM_SELECTION})},backPreviousStep:()=>{l({type:le.BACK_PREVIOUS_STEP})},backToStep:e=>{l({type:le.BACK_TO_STEP,payload:e})},goToReviewStep:()=>{l({type:le.GO_TO_REVIEW_STEP})},confirmSelectedItem:()=>{l({type:le.CONFIRM_SELECTION})},setInitialProgress:async e=>{await l({type:le.INITIAL_PROGRESS,payload:e})},setSelectedItem:e=>{l({type:le.SELECT_SELECTION,payload:e})},setSelectedItems:e=>{l({type:le.SET_SELECTED_ITEMS,payload:e})},setItem:e=>{l({type:le.SET_ITEM,payload:e})},updateProgress:()=>{l({type:le.UPDATE_PROGRESS})},toggleResourcePanel:e=>{l({type:le.TOGGLE_RESOURCE_PANEL,payload:e})},toggleAddPrescriptionPanel:e=>{l({type:le.TOGGLE_ADD_PRESCRIPTION_PANEL,payload:e})},setAddPrescriptionProps:e=>{l({type:le.SET_ADD_PRESCRIPTION_PROPS,payload:e})},setProgress:e=>{l({type:le.SET_PROGRESS,payload:e})}}),[]);return(0,a.jsx)(Me.Provider,{value:o,children:(0,a.jsx)(We.Provider,{value:r.sotData,children:(0,a.jsx)(Ue.Provider,{value:r.progress,children:(0,a.jsx)(je.Provider,{value:r.item,children:(0,a.jsx)(Oe.Provider,{value:r.selections,children:(0,a.jsx)(De.Provider,{value:r.resourceItems,children:(0,a.jsx)(ke.Provider,{value:r.addPrescriptionPanel,children:n})})})})})})})},Be=()=>{const e=(0,S.useContext)(We);if(!e)throw new Error("SOTStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},qe=()=>{const e=(0,S.useContext)(Oe);if(!e)throw new Error("SelectionStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},ze=()=>{const e=(0,S.useContext)(Ue);if(!e)throw new Error("ProgressStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},Qe=()=>{const e=(0,S.useContext)(je);if(!e)throw new Error("ItemStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},Xe=()=>{const e=(0,S.useContext)(De);if(!e)throw new Error("ResourceItemsStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},He=()=>{const e=(0,S.useContext)(ke);if(!e)throw new Error("AddPrescriptionPanelStateContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e},Ye=()=>{const e=(0,S.useContext)(Me);if(!e)throw new Error("SelectionDispatchContext context not available. Did you forget to include the <SelectionContextProvider> in your component hierarchy?");return e};var $e=t(893109),Ke=t(605276),Je=t(508994),Ze=t(969502),en=t(26474);const nn=()=>{const{router:e}=(0,$e.t)();return(0,a.jsx)(en.m,{id:"hw-error-state",imgVariant:"featureTechnicalError",textVariant:"techFeatureError",onClickButtonHandler:()=>{e.push("/")}})},tn=e=>{let{isOpen:n,onClose:t}=e;const l=(0,Ze.M)(600),{0:i,1:c}=(0,S.useState)(!1);return(0,S.useEffect)(()=>{const e=setTimeout(()=>{c(!0)},0);return()=>{clearTimeout(e)}},[]),(0,a.jsxs)(a.Fragment,{children:[!l&&(0,a.jsx)(o.s,{isOpen:n,onClose:t,disableClickOutside:!0,disableKeyDown:!0,isFullHeightInner:!0,"data-testid":"hw-tech-feature-error-panel",children:(0,a.jsx)(nn,{})}),l&&(0,a.jsx)(Ke.Z,{children:(0,a.jsx)(Je.Z,{"data-testid":"hw-tech-feature-error-drawer",isOpen:i,onClose:t,title:"",a11yLabel:(0,s.m)(r,"errorMessageFeature"),UNSAFE_style:{zIndex:1e3},desktopComponent:"bottomsheet",mobileComponent:"bottomsheet",size:"small",children:(0,a.jsx)("div",{className:"vh-75",children:(0,a.jsx)(nn,{})})})})]})};var rn=t(151868),ln=t(560241),an=t(119392),on=t(722057),sn=t(589371),cn=t(978160),dn=t(833836),un=t(158529);var mn=e=>{var n,t,r;const{0:l,1:o}=(0,S.useState)(),{router:i}=(0,$e.t)(),{onATCComplete:s}=e,{closeVisionModal:c}=e,d=(0,un.iC)(ln.Tg),{enablePAC:u,enableACCOnPAC:m,enablePACAOSVariants:p,enableGroceryPAC:y,enableLeanModeATC:f,disableP13nOnPAC:g}=d.cart.values,{baseItemId:v}=(0,cn.N)(),w=(0,sn.ijb)(),x=(0,sn.C62)(),E=(0,sn.TCQ)(),I=(0,sn.mnB)(),L=(0,dn.Gn)(),b=(0,sn.lKQ)().split(":")[1]||"",h={itemId:v,itemPrice:(null===w||void 0===w?void 0:w.price)||0,quantity:1,fulfillmentGroup:x,offerId:E,featureAvailable:{hs:I.some(e=>"HOME_SERVICE"===e.serviceType),cp:I.some(e=>"CAREPLAN"===e.serviceType),acc:m&&I.some(e=>(e=>{var n,t,r;return"ACC_SERVICE"===e.serviceType&&(null===(n=e.groups)||void 0===n||null===(t=n[0])||void 0===t?void 0:t.services)&&(null===(r=e.groups)||void 0===r?void 0:r[0].services.length)>0})(e))||!1},featureSelected:{hs:!!(null===L||void 0===L||null===(n=L.HOME_SERVICE)||void 0===n?void 0:n.offerId),cp:!!(null===L||void 0===L||null===(t=L.CAREPLAN)||void 0===t?void 0:t.offerId)&&1!==p,acc:!!(null===L||void 0===L||null===(r=L.ACC_SERVICE)||void 0===r?void 0:r.offerId)},itemCategory:b},{data:A,isLoading:C,refetch:P}=(0,an.fx)(!1,h);(0,S.useEffect)(()=>{if((null===l||void 0===l?void 0:l.atcResponse)&&!C){var e,n,t,r,a,o,s,d,u,m;const p=(null===(e=null===A||void 0===A?void 0:A.data.contentLayout)||void 0===e||null===(n=e.modules)||void 0===n?void 0:n.some(e=>{var n,t,r,l;const{type:a,configs:o}=e||{},i=o&&"ItemCarousel"===a&&"products"in o&&(null===(n=o.products)||void 0===n?void 0:n.length),s=y&&o&&"ProductGrid"===a&&"productGridResponse"in o&&(null===(t=o.productGridResponse)||void 0===t||null===(r=t[0])||void 0===r||null===(l=r.products)||void 0===l?void 0:l.length);return!g&&i||s}))&&!(null===A||void 0===A||null===(t=A.errors)||void 0===t?void 0:t.length);if(!(null===(r=l.atcResponse)||void 0===r||null===(a=r.data)||void 0===a||null===(o=a.updateItems)||void 0===o||null===(s=o.operationalErrors)||void 0===s?void 0:s.length)&&(!(null===(d=l.atcResponse)||void 0===d||null===(u=d.errors)||void 0===u?void 0:u.length)||f&&(0,on.n)(null===(m=l.atcResponse)||void 0===m?void 0:m.errors))&&p){const e=pn(h);g||i.push("/pac?".concat(e))}else c()}},[l,C,A]);const _={...e,onClickATC:(e,n,t)=>{u&&(.25===n||1===n)&&"INCREMENT"===t&&!g&&P()},onATCComplete:e=>{s&&s(e),o(e)}};return(0,a.jsx)(rn.o,{..._})};function pn(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const t={itemId:"id",itemPrice:"ip",quantity:"qt",fulfillmentGroup:"g",offerId:"oId",featureAvailablehs:"fahs",featureAvailablecp:"facp",featureAvailableacc:"faacc",featureSelectedhs:"fshs",featureSelectedcp:"fscp",featureSelectedacc:"fsacc",itemCategory:"cat"},r=Object.entries(e).map(e=>{let[r,l]=e;if("object"===typeof l)return pn(l,"".concat(n).concat(r));return[t[n+r],l].map(e=>encodeURIComponent("boolean"===typeof e?e.toString().slice(0,1):e)).join("=")});return r.join("&")}var yn=t(468620),fn=t(465903);const gn="lens_c11n",vn=e=>{let{isUserRedirectLoggedIn:n}=e;var t,r;const{authState:l}=(0,yn.Eu)(),a=qe(),o=Qe(),{setSelectedItems:i,setProgress:s,setInitialProgress:c}=Ye(),d=ze();return(0,S.useEffect)(()=>{const e=(0,fn.D)(gn);if(c({currentStep:q.RX_TYPE}),e){const a=(e=>{try{var n;const t=e,r=["header","body","price","index","type","step"],l=null===t||void 0===t||null===(n=t.selections)||void 0===n?void 0:n.every(e=>{const n=Object.keys(e);return r.every(e=>n.includes(e))});if(t&&l&&K(t.id)&&K(t.email))return!0}catch{return!1}return!1})(e);if(a){var t;const a=e;var r;if(parseInt(a.id,10)===parseInt((null===o||void 0===o||null===(t=o.atcItem)||void 0===t?void 0:t.usItemId)||"",10)&&(""===a.email||a.email===(null===l||void 0===l?void 0:l.emailAddress)))i(a.selections),n&&(null===a||void 0===a||null===(r=a.progress)||void 0===r?void 0:r.currentStep)===q.REVIEW&&s({...a.progress,isUserLoginRedirect:!0,isTriggerUserLogin:!1})}else window.localStorage.removeItem(gn)}},[null===(t=o.atcItem)||void 0===t?void 0:t.usItemId,null===l||void 0===l?void 0:l.emailAddress,i,n,s,c]),(0,S.useEffect)(()=>{var e;const n={id:(null===(e=o.atcItem)||void 0===e?void 0:e.usItemId)||"",email:(null===l||void 0===l?void 0:l.emailAddress)||"",selections:a.selectedItems};d.isTriggerUserLogin&&(n.progress={...d}),n.selections&&n.selections.length>0&&(0,fn.c)(gn,n)},[a.selectedItems,null===(r=o.atcItem)||void 0===r?void 0:r.usItemId,null===l||void 0===l?void 0:l.emailAddress,o.atcItem,d]),null},wn=e=>{let{onClosePanel:n}=e;var t,r;const l=Qe(),o=He(),{product:i}=Be(),s=ze(),{selectedItems:c}=qe(),{setSelectedItems:d}=Ye(),u=o.ecomVisionRxId&&o.ecomProfileId?{prescriptionId:o.ecomVisionRxId,profileId:o.ecomProfileId}:void 0,m={groupType:null===(t=i.groupMetaData)||void 0===t?void 0:t.groupType,groupSubType:null===(r=i.groupMetaData)||void 0===r?void 0:r.groupSubType};return(0,a.jsx)(mn,{rxItemRequestInfo:u,closeVisionModal:()=>{n()},groupMetaData:m,onATCComplete:e=>{var n,t,r,l;0===(null===e||void 0===e||null===(n=e.atcResponse)||void 0===n||null===(t=n.data)||void 0===t||null===(r=t.updateItems)||void 0===r||null===(l=r.operationalErrors)||void 0===l?void 0:l.length)&&(d([]),window.localStorage.removeItem(gn))},showAddedTextOnClickATC:!0,isNonOptimistic:!0,beaconData:{pg:{nm:"selectLenses"},li:{nm:"addToCart"},nm:{nm:"addToCart"},pr:{us:l.atcItem.usItemId,hrd:(null===u||void 0===u?void 0:u.prescriptionId)?1:0,ra:(null===u||void 0===u?void 0:u.prescriptionId)?1:0},ta:{pt:"selectLenses",ty:"reviewLensSection"}},isFullWidth:!0,item:J(l.atcItem,s,c,i),defaultState:"expanded"})},Sn=e=>{let{onClosePanel:n}=e;const{0:t,1:l}=(0,S.useState)(1),o=ze(),d=qe(),u=Ye(),m=(0,c.wG)(),p=Qe(),y=(0,Ze.M)(600);return(0,a.jsxs)("div",{className:"flex flex-column flex-auto ".concat(y?"pa0":"pa2"),children:[o.currentStep!==q.REVIEW&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"ma0 mb3 self-end",children:[(0,a.jsx)(i.Body,{as:"span",size:"medium",weight:400,children:(0,s.m)(r,"subtotal")}),(0,a.jsx)("span",{className:"ml1 b",children:(0,s.m)(r,"currency",{price:d.displaySubtotal.toString()})})]}),(0,a.jsx)(i.Button,{size:"medium",variant:"primary",isFullWidth:!0,onClick:()=>{(0,f.fR)(Z(o.currentStep),m,"continue",{pr:{us:p.atcItem.usItemId}}),setTimeout(()=>l(Math.random()),100),d.isEditModeNoChanges&&JSON.stringify(d.confirmedSelectedItems)===JSON.stringify(d.selectedItems)?u.goToReviewStep():(u.attemptConfirm(),"undefined"!==typeof d.localSelection&&(u.confirmSelectedItem(),u.updateProgress()))},children:(0,s.m)(r,"continueLabel")},t)]}),o.currentStep===q.REVIEW&&(0,a.jsx)(wn,{onClosePanel:n})]})},xn=()=>{const{toggleResourcePanel:e}=Ye();return(0,a.jsx)("div",{className:"flex flex-column flex-auto pa2",children:(0,a.jsx)(i.Button,{size:"medium",variant:"primary",isFullWidth:!0,onClick:()=>{e(!1)},children:(0,s.m)(r,"gotItLabel")})})};var En=t(227297),In=t(543073);const Ln=e=>{let{showInfoIcon:n,onInfoIconClick:t}=e;const l=ze(),o=(()=>{switch(l.currentStep){case q.RX_TYPE:return(0,s.m)(r,"headerRxType");case q.LENS_TYPE:return(0,s.m)(r,"headerLensType");case q.LENS_MATERIAL:return(0,s.m)(r,"headerLensMaterial");case q.LENS_COLOR:return(0,s.m)(r,"headerLensColor");case q.ADD_ONS:return(0,s.m)(r,"headerAddOns");case q.REVIEW:return(0,s.m)(r,"headerReview");default:return"";}})();return(0,a.jsxs)("div",{className:"mt3 mb3 f3 dark-gray b di",children:[(0,a.jsx)("div",{role:"heading","aria-level":2,className:"di",children:o}),n&&(0,a.jsx)(In.C,{className:"br4 pl2","aria-label":"Information about ".concat(l.label),onClick:t,children:(0,a.jsx)(En.J,{name:"InfoCircle",style:{fontSize:"1.25rem"}})})]})},bn={type:"query",name:"HWVisionResourceItemsTempo",query:"query HWVisionResourceItemsTempo($pageType:String! = \"HWVisionResourceItems\"){contentLayout(channel:\"WWW\" pageType:$pageType tenant:\"WM_GLASS\"){modules{type configs{...on TempoWM_GLASSWWWHWVisionResourceItemsConfigs{sections{sectionTitle type resourceItems{identifier subidentifier title description descriptionList{descriptionListItem}image{height width alt src}secondaryImage{height width alt src}hasImageToggle imageToggleCta}}}}}}}",hash:"65c2b0693319bf10512d40e6a01e50b53bad08a003fe6755934da52247d229a8"},hn=()=>{var e,n,t;const r=(l=(0,d.Z)(),{queryKey:["hw-vision-resource-items-tempo"],queryFn:()=>l.getGqlFetch()(bn),config:{refetchOnWindowFocus:!1,cacheTime:1/0,staleTime:36e5}});var l;const{data:a,error:o,isFetching:i,isLoading:s,refetch:c}=(0,u.a)(r),p=null===a||void 0===a||null===(e=a.data)||void 0===e||null===(n=e.contentLayout)||void 0===n||null===(t=n.modules)||void 0===t?void 0:t.find(e=>"HWVisionResourceItems"===(null===e||void 0===e?void 0:e.type));return{errors:(0,m.k)(null===a||void 0===a?void 0:a.errors,o),isFetching:i,isLoading:s,data:p,refetch:c}};var An=t(420236),Cn=t(936176);const Pn=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Skeleton,{UNSAFE_className:"fr",height:"32px",width:"40px",variant:"rectangle"}),(0,a.jsx)(i.Skeleton,{UNSAFE_className:"mb2",height:"32px",width:"194px",variant:"rectangle"}),(0,a.jsx)(i.SkeletonText,{UNSAFE_className:"mb3",lines:2}),(0,a.jsx)(i.Skeleton,{UNSAFE_className:"mb4",height:"240px",variant:"rectangle"})]}),_n=()=>(0,a.jsxs)("div",{"data-testid":"hw-loading-state",children:[(0,a.jsx)(Pn,{}),(0,a.jsx)(Pn,{})]}),Nn=e=>{let{data:n,errors:t,isLoading:r,refetch:l,onBack:o}=e;var s,c;return r?(0,a.jsx)(_n,{}):t||!n||0===(null===n||void 0===n||null===(s=n.resourceItems)||void 0===s?void 0:s.length)?(0,a.jsx)(en.m,{id:"hw-error-state",imgVariant:"resourceItemsError",textVariant:"closeGenericError",onClickButtonHandler:l,onClickRedirectHandler:o}):(0,a.jsx)("div",{className:"flex-column w-100",children:null===n||void 0===n||null===(c=n.resourceItems)||void 0===c?void 0:c.map((e,t)=>{let{title:r,image:l,description:o,secondaryImage:s,imageToggleCta:c,descriptionList:d,itemLabel:u}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)(Cn.L,{title:r,image:l,content:o,switchData:s&&{secondImage:s,switchLabel:c},trailingInfo:u,bulletPoints:d}),t<(null===n||void 0===n?void 0:n.resourceItems.length)-1&&(0,a.jsx)("div",{className:"mv3",children:(0,a.jsx)(i.Divider,{})})]},r)})})},Tn=()=>{var e;const n=ze(),{selectionList:t,selectedItems:l,isSunglasses:i}=qe(),{toggleResourcePanel:c}=Ye(),{errors:d,isLoading:u,data:m,refetch:p}=hn(),y=(0,Ze.M)(600),f=null===m||void 0===m?void 0:m.configs,g=Q(f,n,t,l,i),v=d||!g||0===(null===g||void 0===g||null===(e=g.resourceItems)||void 0===e?void 0:e.length),w=n.currentStep!==q.REVIEW,S=()=>{c(!1)};var x;return(0,a.jsxs)(Ke.Z,{children:[w&&y&&(0,a.jsx)(Je.Z,{desktopComponent:"bottomsheet",mobileComponent:"bottomsheet",isOpen:!0,onClose:S,size:"small",title:v?" ":null!==(x=null===g||void 0===g?void 0:g.sectionTitle)&&void 0!==x?x:"Loading",UNSAFE_style:{zIndex:1e3},children:(0,a.jsx)(An.T,{onClickHandler:S,buttonLabel:(0,s.m)(r,"gotItLabel"),children:(0,a.jsx)("div",{style:{paddingBottom:"10px"},children:(0,a.jsx)(Nn,{data:g,errors:d,isLoading:u,refetch:p,onBack:S})})})}),w&&!y&&(0,a.jsx)(o.s,{isOpen:!0,onBack:S,onClose:()=>{},title:v?"":null===g||void 0===g?void 0:g.sectionTitle,actions:(0,a.jsx)(xn,{}),isLayeredPanel:!0,disableClickOutside:!0,disableKeyDown:!0,showCloseBtn:!1,children:(0,a.jsx)(Nn,{data:g,errors:d,isLoading:u,refetch:p,onBack:S})})]})},Rn=()=>{const e=ze(),{toggleResourcePanel:n}=Ye(),{isPanelOpen:t}=Xe(),r=(0,c.wG)(),l=Qe(),o=e.currentStep!==q.REVIEW;return(0,a.jsxs)("legend",{className:"flex items-center",children:[(0,a.jsx)(Ln,{showInfoIcon:o,onInfoIconClick:()=>{n(!0),(0,f.fR)(Z(e.currentStep),r,"information",{pr:{us:l.atcItem.usItemId}})}}),o&&t&&(0,a.jsx)(Tn,{})]})},Fn=()=>{const e=qe();return e.confirmAttempted&&"undefined"===typeof e.localSelection?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Alert,{variant:"error",role:"alert",children:(0,s.m)(r,"alertMissingOption")}),(0,a.jsx)("div",{className:"mb3"})]}):null};var Vn=t(377922),Mn=t(444510),jn=t(803528),On=t(603868);const Wn=e=>{let{heading:n,image:t}=e;const{0:r,1:l}=(0,S.useState)(!0),{0:o,1:s}=(0,S.useState)(!1);return(0,S.useEffect)(()=>{if(s(!0),""===t.src)l(!1),s(!1);else{const e=new Image;e.src=t.src,e.onload=()=>{0===e.height?l(!1):l(!0),s(!1)},e.onerror=()=>{l(!1)}}},[l,t.src]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pv3 bg-white flex-column",children:(0,a.jsxs)("div",{className:"flex justify-between flex-column h-100",children:[(0,a.jsx)("p",{className:"f6 mb3 mt0 normal f5 overflow-hidden nowrap",style:{color:Vn.LgQ,textOverflow:"ellipsis",visibility:o?"hidden":"visible"},children:n}),(0,a.jsx)("div",{className:"pa3 ".concat(!r&&!o&&"overflow-hidden br3 bg-nearer-white"),children:(0,a.jsx)("div",{className:"w-100 relative",style:{height:0,paddingBottom:"35.117057%"},children:o?(0,a.jsx)("div",{className:"flex justify-center items-center absolute absolute--fill",style:{bottom:"36px"},children:(0,a.jsx)(On.$,{color:"gray",size:"large",a11yLabel:"loading"})}):r?(0,a.jsx)(jn.Z,{className:"absolute absolute--fill",alt:t.alt,src:t.src,width:"100%",height:"100%",preload:!0}):(0,a.jsx)(Mn.p,{})})})]})}),(0,a.jsx)(i.Divider,{})]})},Un=()=>{const e=Qe();return(0,a.jsx)(Wn,{heading:e.heading,image:e.image})},Dn=()=>{const e=ze(),n=(0,S.useRef)(null);return(0,S.useEffect)(()=>{var e;const t=null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.querySelector("[id=\"progress-bar\"]");t&&t.focus()},[e.value]),(0,a.jsxs)("div",{ref:n,children:[(0,a.jsx)(i.ProgressIndicator,{tabIndex:0,id:"progress-bar",label:e.label,value:e.value,valueLabel:e.valueLabel,variant:"info"}),(0,a.jsx)("div",{className:"nr3 nl3 nr4-m nl4-m mt3 mt4-m",children:(0,a.jsx)(i.Divider,{})})]})};var kn=t(590723);const Gn=()=>"Add prescription",Bn=()=>"Edit",qn=()=>"Frames",zn=()=>"Lenses",Qn=()=>"Add your prescription now, or you can wait until checkout",Xn=()=>"You added your prescription and saved time at checkout!",Hn=()=>"Does everything look right to you?",Yn=()=>"Subtotal",$n=e=>e.input+" lenses",Kn=e=>e.input+" material",Jn=e=>e.input+" lens color",Zn=e=>e.input+" add-on",et="SUNGLASSES",nt=e=>{switch(e){case q.RX_TYPE:return"editPrescriptionType";case q.LENS_TYPE:return"editLensType";case q.LENS_MATERIAL:return"editLensMaterial";case q.LENS_COLOR:return"editLensColor";case q.ADD_ONS:return"editLensAddon";default:return e;}},tt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q.RX_TYPE,n=arguments.length>1?arguments[1]:void 0;switch(e){case q.LENS_TYPE:return n.toUpperCase()===et?n:(0,s.m)(l,"lensesType",{input:n});case q.LENS_MATERIAL:return(0,s.m)(l,"lensesMaterial",{input:n});case q.LENS_COLOR:return(0,s.m)(l,"lensesColor",{input:n});case q.ADD_ONS:return(0,s.m)(l,"lensesAddOns",{input:n});default:return n;}},rt=e=>{let{analytics:n,data:t,totalValue:r,type:o,editHandler:d}=e;const u=o===z.FRAMES?"framesLabel":"lensesLabel",m=(0,c.wG)();return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center f4 lh24",children:[(0,a.jsx)("h3",{"aria-label":(0,s.m)(l,u),className:"f4 ma0 dark-gray",children:(0,s.m)(l,u)}),(0,a.jsx)("span",{"aria-label":r,className:"f5 ma0 dark-gray",children:r})]}),t.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center f5 pt2 lh20",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsxs)("span",{"aria-label":o===z.FRAMES?e.value:e.variant,className:"f6 ma0",style:{color:Vn.LgQ},children:[" ",o===z.FRAMES?e.value:tt(e.type,e.variant)]}),o===z.LENSES&&(0,a.jsx)(i.Button,{role:"button",variant:"tertiary","aria-label":"Edit ".concat(tt(e.type,e.variant)),UNSAFE_className:"h1 ph2 black",onClick:()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q.RX_TYPE;d&&(d(e),(0,f.fR)((null===n||void 0===n?void 0:n.pageType)||"",m,nt(e),{pr:{us:null===n||void 0===n?void 0:n.itemID,hrd:null===n||void 0===n?void 0:n.rxAdded}}))}(e.type),children:(0,s.m)(l,"editBtn")})]}),o===z.LENSES&&(0,a.jsx)("span",{"aria-label":e.value,className:"f6 ma0",style:{color:Vn.LgQ},children:e.value})]},"".concat(t,"-").concat(e.variant))),(0,a.jsx)("div",{className:"mv3",children:(0,a.jsx)(i.Divider,{})})]})},lt=e=>{let{actionHandler:n,isRxAdded:t}=e;return(0,a.jsx)("div",{className:"mt3 mb3",children:(0,a.jsx)(i.Nudge,{leading:(0,a.jsx)(jn.Z,{width:"56px",height:"56px",src:"//i5.walmartimages.com/dfw/63fd9f59-7537/2d7433bf-71e6-4764-b7bd-5bd26468ef69/v1/".concat(t?"PrescriptionAdded_circle":"Prescription_circle",".svg"),alt:"",loading:"eager",preload:!1}),actions:!t&&(0,a.jsx)(i.Button,{variant:"secondary",UNSAFE_className:"ml3",onClick:n,children:(0,s.m)(l,"cta")}),title:"",children:(0,a.jsx)("span",{className:"db nt2 f5",children:(0,s.m)(l,t?"nudgeLabelAdded":"nudgeLabel")})})})},at=e=>{let{analytics:n,pricingDetailsData:t,actionHandler:r,isRxAdded:o,editHandler:i=e=>{}}=e;const{totalPrice:c,framesPrice:d,lensesPrice:u,framesSelection:m,lensesSelection:p}=t;return(0,a.jsxs)("div",{children:[(0,a.jsx)(rt,{analytics:n,data:m,type:z.FRAMES,totalValue:d}),(0,a.jsx)(rt,{analytics:n,data:p,type:z.LENSES,totalValue:u,editHandler:i}),(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center mt3",children:[(0,a.jsx)("h2",{"aria-label":(0,s.m)(l,"subtotalLabel"),className:"f4 ma0 dark-gray",children:(0,s.m)(l,"subtotalLabel")}),(0,a.jsx)("span",{"aria-label":c,className:"f5 b ma0",children:c})]}),(0,a.jsx)(lt,{actionHandler:r,isRxAdded:o})]})};var ot=t(685890),it=t(744196),st=t(874155);const ct=e=>{let{lineItemId:n,setShowLoadingScreen:t,onCloseHandler:r,onRxAdded:l}=e;const{toggleAddPrescriptionPanel:o,setAddPrescriptionProps:i}=Ye(),s=Qe(),[c,d]=(0,ot.iQ)(),[u]=(0,it.oV)({dispatch:d,state:c,wppCall:!0}),m=(0,kn.wh)(),p=ze(),y=(0,kn.cF)(),{product:f}=Be(),{selectedItems:v}=qe();return(0,a.jsx)(st.y,{isLayeredPanel:!0,isOpen:!0,onClose:()=>o(!1),lineItemId:n,onDone:async(e,n)=>{i(e),o(!1),l&&l();const a=f.offerId,c=m.find(e=>{var n;return(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.offerId)===a});if((null===c||void 0===c?void 0:c.quantity)&&(null===c||void 0===c?void 0:c.quantity)>0){var d;const n=J(s.atcItem,p,v,f);if(null===n||void 0===n||null===(d=n.bundleComponents)||void 0===d?void 0:d.every(e=>{var n;return null===(n=c.bundleComponents)||void 0===n?void 0:n.some(n=>n&&e&&n.offerId===e.offerId)})){var w,S;t(!0);const n={cartId:y,items:[{offerId:a,quantity:c.quantity,rxItemRequestInfo:{profileId:e.ecomVisionRxId,prescriptionId:e.ecomVisionRxId},groupMetaData:{groupType:f.groupMetaData.groupType,groupSubType:f.groupMetaData.groupSubType},additionalInfo:{bundleComponents:c.bundleComponents}}]},l=await u({input:n});t(!1);var x,E;if(i({ecomVisionRxId:"",ecomProfileId:""}),!l||l.errors&&l.errors.length>0||(null===(w=l.data)||void 0===w||null===(S=w.updateItems)||void 0===S?void 0:S.operationalErrors)&&l.data.updateItems.operationalErrors.length>0)r(),(0,g.cM)(["info","vision-center","mutateAddToCart"],{type:"log",message:"Rx update cart failed with errors ".concat(JSON.stringify((null===l||void 0===l?void 0:l.errors)||(null===l||void 0===l||null===(x=l.data)||void 0===x||null===(E=x.updateItems)||void 0===E?void 0:E.operationalErrors)||"cartUpdateResult null")),modules:["lens-selection"]})}}}})},dt=e=>{let{onGuestAddPrescription:n,setShowLoadingScreen:t,onCloseHandler:l}=e;const o=(0,Ze.M)(600),{addSnack:d}=(0,i.useSnackbar)(),u=Qe(),m=qe(),{isPanelOpen:p}=He(),{toggleAddPrescriptionPanel:y,backToStep:g,setProgress:v}=Ye(),w=He(),x=ze(),E=m.selectedItems||[],{authState:I}=(0,yn.Eu)(),L=(0,c.wG)(),{product:b}=Be();(0,S.useEffect)(()=>{x.isUserLoginRedirect&&y(!0)},[x.isUserLoginRedirect,y]);const h=J(u.atcItem,x,E,b),A=((e,n)=>{var t;const r=(0,kn.wh)().filter(n=>n.product.offerId===e).find(e=>{var t;const r=null===(t=e.bundleComponents)||void 0===t?void 0:t.map(e=>null===e||void 0===e?void 0:e.offerId),l=null===n||void 0===n?void 0:n.map(e=>null===e||void 0===e?void 0:e.offerId);return(null===r||void 0===r?void 0:r.sort().toString())===(null===l||void 0===l?void 0:l.sort().toString())});return!!(null===r||void 0===r||null===(t=r.rxDetails)||void 0===t?void 0:t.prescriptionId)})(h.offerId,h.bundleComponents),C=A||!!(null===w||void 0===w?void 0:w.ecomProfileId)&&!!(null===w||void 0===w?void 0:w.ecomVisionRxId);(0,S.useEffect)(()=>{C&&(0,f.pb)(Z(x.currentStep),L,{pr:{us:u.atcItem.usItemId},co:{hrd:1}})},[C,u.atcItem.usItemId,x,L]);const P={context:f.J8,name:f.E3,pageType:Z(x.currentStep),itemID:u.atcItem.usItemId,rxAdded:C?1:0};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(at,{analytics:P,pricingDetailsData:H(u.basePrice,E,u.variants),actionHandler:()=>{(0,f.fR)(Z(x.currentStep),L,f.c8,{pr:{us:u.atcItem.usItemId}}),I.isLoggedIn?y(!0):(v({...x,isTriggerUserLogin:!0}),setTimeout(()=>{n()},200))},isRxAdded:C,editHandler:e=>{g(e)}}),p&&(0,a.jsx)(ct,{setShowLoadingScreen:t,lineItemId:u.atcItem.lineItemId||"",onCloseHandler:l,onRxAdded:()=>{o&&d({UNSAFE_style:{bottom:100,position:"relative"},message:(0,s.m)(r,"rxAdded")})}})]})};var ut=t(515868);const mt=e=>{let{analytics:n,configs:t,selectHandler:r,selectedIndex:l}=e;const{selectionItems:o}=t;return(0,a.jsx)("section",{className:"flex flex-column",children:null===o||void 0===o?void 0:o.map((e,t)=>e&&(0,a.jsx)("div",{className:"".concat(0===t?"":"mt3"),children:(0,a.jsx)(ut.Q,{analytics:n,...e,selectHandler:r,index:t,isSelected:l===t})},null===e||void 0===e?void 0:e.header))})},pt=()=>{const e=qe(),n=ze(),t=Qe(),{setSelectedItem:r}=Ye(),{0:l,1:o}=(0,S.useState)(-1),i={configs:{selectionItems:e.selectionList}};(0,S.useEffect)(()=>{var t;const l=null===(t=e.confirmedSelectedItems)||void 0===t?void 0:t.find(e=>e.step===n.currentStep);if(l){const n=e.selectionList.findIndex(e=>e.type===l.type);n<0?o(-1):(o(n),r(l))}else o(-1)},[n.currentStep,e.selectionList,o,r,e.confirmedSelectedItems]);const s={context:f.J8,name:f.E3,pageType:Z(n.currentStep),itemID:t.atcItem.usItemId};return(0,a.jsx)(mt,{analytics:s,...i,selectHandler:n=>{const t=e.selectionList[n],a=l===n?-1:n;t&&(o(a),r({...t,index:a}))},selectedIndex:l})},yt=e=>{let{onGuestAddPrescription:n,setShowLoadingScreen:t,onCloseHandler:r}=e;return ze().currentStep===q.REVIEW?(0,a.jsx)(dt,{onGuestAddPrescription:n,setShowLoadingScreen:t,onCloseHandler:r}):(0,a.jsx)(pt,{})},ft=e=>{let{isUserRedirectLoggedIn:n,onGuestAddPrescription:t,setShowLoadingScreen:r,onCloseHandler:l}=e;const o=ze(),i=(0,c.wG)(),s=Qe(),d=(0,S.useRef)(null);return(0,S.useEffect)(()=>{"reviewLensSelection"!==Z(o.currentStep)&&(0,f.pb)(Z(o.currentStep),i,{pr:{us:s.atcItem.usItemId}}),"reviewLensSelection"===Z(o.currentStep)&&(0,f.pb)(Z(o.currentStep),i,{pr:{us:s.atcItem.usItemId},co:{hrd:0}})},[s.atcItem.usItemId,o.currentStep,i]),(0,S.useEffect)(()=>{d.current&&(d.current.scrollTop=0)},[o.currentStep,d.current]),(0,a.jsxs)("div",{className:"flex flex-column h-100",children:[(0,a.jsx)(Dn,{}),(0,a.jsxs)("div",{className:"flex-auto overflow-y-auto overflow-x-hidden nr3 pr3 nr4-m pr4-m pb4",ref:d,children:[(0,a.jsx)(Un,{}),(0,a.jsxs)("fieldset",{className:"b--none pa0 ma0",children:[(0,a.jsx)(Rn,{}),(0,a.jsx)(Fn,{}),(0,a.jsx)(yt,{onGuestAddPrescription:t,setShowLoadingScreen:r,onCloseHandler:l})]})]}),(0,a.jsx)(vn,{isUserRedirectLoggedIn:n})]})},gt=()=>(0,a.jsxs)("div",{className:"flex flex-column h-100",children:[(0,a.jsx)(i.Skeleton,{height:"32px",variant:"rectangle"}),(0,a.jsx)("div",{className:"nl4 nr4 mt3",children:(0,a.jsx)(i.Divider,{})}),(0,a.jsxs)("div",{className:"flex-auto overflow-y-auto",children:[(0,a.jsx)("div",{className:"w-60 pv3",children:(0,a.jsx)(i.SkeletonText,{lines:1})}),(0,a.jsx)(i.Skeleton,{UNSAFE_className:"mb3",height:"125px",variant:"rectangle"}),(0,a.jsx)("div",{className:"w-75 pv3",children:(0,a.jsx)(i.Skeleton,{height:"28px",variant:"rectangle"})}),(0,a.jsx)(i.Skeleton,{height:"103px",variant:"rectangle"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"nl4 nr4 self-end",children:(0,a.jsx)(i.Divider,{})}),(0,a.jsx)("div",{className:"pv3 flex justify-end",children:(0,a.jsx)(i.SkeletonText,{UNSAFE_className:"w-40",lines:1})}),(0,a.jsx)(i.Skeleton,{height:"32px",variant:"rounded"})]})]}),vt=e=>{let{children:n,onClose:t,item:l,associatedBundleId:i,variants:d,showLoadingScreen:u,...m}=e;const p=ze(),{isPanelOpen:y}=Xe(),{isPanelOpen:g}=He(),v=Ye(),w=(0,c.wG)();(0,S.useEffect)(()=>{v.setItem({atcItem:l,associatedBundleId:i,variants:d,basePrice:l.price,heading:l.product.name||""})},[v,i,l,d]);const x=()=>{y||g||(t(),(0,f.fR)(Z(p.currentStep),w,"close",{pr:{us:l.usItemId}}))};return(0,a.jsx)(o.s,{...m,actions:(0,a.jsx)(Sn,{onClosePanel:x}),isFullHeightInner:!0,disableClickOutside:!0,onBack:p.currentStep===q.RX_TYPE?void 0:()=>{v.backPreviousStep(),(0,f.fR)(Z(p.currentStep),w,"back",{pr:{us:l.usItemId}})},onClose:x,title:p.currentStep===q.REVIEW?(0,s.m)(r,"reviewPanelTitle"):(0,s.m)(r,"selectionPanelTitle"),hidePanel:g,loader:u,innerContentClassNames:"pb0",children:n})},wt=e=>{let{isOpen:n,onClose:t,item:l,associatedBundleId:c,variants:d,isUserRedirectLoggedIn:u,onGuestAddPrescription:m}=e;const{data:p,isFetching:f,errors:g}=y({itemId:l.usItemId||"",associateBundleId:c}),{0:v,1:w}=(0,S.useState)(!1);return f?(0,a.jsx)(o.s,{isFullHeightInner:!0,disableClickOutside:!0,isOpen:n,onClose:t,title:(0,s.m)(r,"selectionPanelTitle"),children:(0,a.jsx)(gt,{})}):g?(0,a.jsx)(tn,{isOpen:n,onClose:t}):(0,a.jsx)(E,{lineItemId:null===l||void 0===l?void 0:l.lineItemId,usItemId:null===l||void 0===l?void 0:l.usItemId,offerId:(null===l||void 0===l?void 0:l.offerId)||"",associatedBundleId:c,modules:["lens-selection"],scope:"vision-center",FallbackComponent:()=>(0,a.jsx)(tn,{isOpen:n,onClose:t}),children:(0,a.jsx)(Ge,{data:p,children:(0,a.jsx)(vt,{isOpen:n,disableClickOutside:!0,disableKeyDown:!0,onClose:t,item:l,associatedBundleId:c,variants:d,showLoadingScreen:v,children:(0,a.jsx)(i.SnackbarProvider,{children:(0,a.jsx)(ft,{isUserRedirectLoggedIn:u,onGuestAddPrescription:m,setShowLoadingScreen:w,onCloseHandler:t})})})})})}},606942:function(e){e.exports={image:"w_B0sl"}},290178:function(e){e.exports={borderDefault:"w_1C_N",iconContainer:"w_90Ra",icon:"w_Asuh"}},745756:function(e){e.exports={card:"w_wOcC",large:"w_ro9z",medium:"w_EjQC",small:"w_QspX"}}}]);